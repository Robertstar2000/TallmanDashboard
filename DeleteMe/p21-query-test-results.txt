=== P21 Query Test ===
Starting test at 2025-03-20T12:47:19.186Z

Testing query: Total Orders
SQL: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE order_date >= DATEADD(day, -7, GETDATE())
Using Windows Authentication with ODBC
Creating ODBC connection with DSN: P21Play
Executing query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE order_date >= DATEADD(day, -7, GETDATE())
Query result: [{"value":18}]
ODBC connection closed
Execution time: 31ms
First row: {"value":18}
Found 'value' column with value: 18 (type: number)
SUCCESS: Query returned non-zero value: 18
---
Testing query: Open Orders
SQL: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N'
Using Windows Authentication with ODBC
Creating ODBC connection with DSN: P21Play
Executing query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N'
Query result: [{"value":2034}]
ODBC connection closed
Execution time: 12ms
First row: {"value":2034}
Found 'value' column with value: 2034 (type: number)
SUCCESS: Query returned non-zero value: 2034
---
Testing query: Open Orders Value
SQL: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.completed = 'N'
Using Windows Authentication with ODBC
Creating ODBC connection with DSN: P21Play
Executing query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.completed = 'N'
Query result: [{"value":24643150.24}]
ODBC connection closed
Execution time: 146ms
First row: {"value":24643150.24}
Found 'value' column with value: 24643150.24 (type: number)
SUCCESS: Query returned non-zero value: 24643150.24
---
Testing query: Daily Revenue
SQL: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE CONVERT(date, h.order_date) = CONVERT(date, DATEADD(day, -1, GETDATE()))
Using Windows Authentication with ODBC
Creating ODBC connection with DSN: P21Play
Executing query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE CONVERT(date, h.order_date) = CONVERT(date, DATEADD(day, -1, GETDATE()))
Query result: [{"value":75500}]
ODBC connection closed
Execution time: 36ms
First row: {"value":75500}
Found 'value' column with value: 75500 (type: number)
SUCCESS: Query returned non-zero value: 75500
---
Testing query: Open Invoices
SQL: SELECT COUNT(*) as value FROM dbo.invoice_hdr WITH (NOLOCK) WHERE invoice_date >= DATEADD(month, -1, GETDATE())
Using Windows Authentication with ODBC
Creating ODBC connection with DSN: P21Play
Executing query: SELECT COUNT(*) as value FROM dbo.invoice_hdr WITH (NOLOCK) WHERE invoice_date >= DATEADD(month, -1, GETDATE())
Query result: [{"value":1}]
ODBC connection closed
Execution time: 11ms
First row: {"value":1}
Found 'value' column with value: 1 (type: number)
SUCCESS: Query returned non-zero value: 1
---

Test completed at 2025-03-20T12:47:19.429Z
Results saved to C:\Users\BobM\CascadeProjects\TallmanDashboard_new\p21-query-test-results.txt
