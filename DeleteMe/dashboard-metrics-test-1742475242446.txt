
--- P21 Connection Test ---
Connection string: DSN=P21Play;Trusted_Connection=Yes;
Connecting to ODBC data source...
✅ CONNECTED SUCCESSFULLY to ODBC data source!

--- Server Information ---
Server: SQL01
Database: P21Play

--- Dashboard Metrics Test ---

--- Total Orders ---
Query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE order_date >= DATEADD(day, -7, GETDATE())
✅ Query executed successfully in 4ms
✅ Value: 18 (type: number)
✅ SUCCESS: Query returned non-zero value: 18
Raw result: {"value":18}

--- Open Orders ---
Query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N'
✅ Query executed successfully in 0ms
✅ Value: 2034 (type: number)
✅ SUCCESS: Query returned non-zero value: 2034
Raw result: {"value":2034}

--- Open Orders 2 ---
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.completed = 'N'
✅ Query executed successfully in 152ms
✅ Value: 24643150.24 (type: number)
✅ SUCCESS: Query returned non-zero value: 24643150.24
Raw result: {"value":24643150.24}

--- Daily Revenue ---
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE CONVERT(date, h.order_date) = CONVERT(date, DATEADD(day, -1, GETDATE()))
✅ Query executed successfully in 46ms
✅ Value: 75500 (type: number)
✅ SUCCESS: Query returned non-zero value: 75500
Raw result: {"value":75500}

--- Open Invoices ---
Query: SELECT COUNT(*) as value FROM dbo.invoice_hdr WITH (NOLOCK) WHERE invoice_date >= DATEADD(month, -1, GETDATE())
✅ Query executed successfully in 1ms
✅ Value: 1 (type: number)
✅ SUCCESS: Query returned non-zero value: 1
Raw result: {"value":1}

--- Orders Backlogged ---
Query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N' AND order_date >= DATEADD(day, -30, GETDATE())
✅ Query executed successfully in 4ms
✅ Value: 27 (type: number)
✅ SUCCESS: Query returned non-zero value: 27
Raw result: {"value":27}

--- Total Monthly Sales ---
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.order_date >= DATEADD(day, -30, GETDATE())
✅ Query executed successfully in 11ms
✅ Value: 1708263.24 (type: number)
✅ SUCCESS: Query returned non-zero value: 1708263.24
Raw result: {"value":1708263.24}

--- Results Summary ---
Total metrics tested: 7
Successful metrics: 7
Failed metrics: 0

Metric values:
- Total Orders: 18
- Open Orders: 2034
- Open Orders 2: 24643150.24
- Daily Revenue: 75500
- Open Invoices: 1
- Orders Backlogged: 27
- Total Monthly Sales: 1708263.24

Results saved to JSON file: C:\Users\BobM\CascadeProjects\TallmanDashboard_new\dashboard-metrics-results-1742475242711.json

--- Connection closed ---
