
--- P21 Connection Test ---
Using Windows Authentication with ODBC
Connection string: DSN=P21Play;Trusted_Connection=Yes;
Connecting to ODBC data source...
✅ CONNECTED SUCCESSFULLY to ODBC data source!

--- Server Information ---
Server: SQL01
Database: P21Play

--- Table Existence Check ---
Found tables: invoice_hdr, oe_hdr, oe_line

--- Dashboard Queries Test ---

--- Total Orders ---
Original query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE order_date >= DATEADD(day, -7, GETDATE())

Default (dbo):
Query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE order_date >= DATEADD(day, -7, GETDATE())
✅ Query executed successfully in 4ms
✅ Value: 18 (type: number)
✅ SUCCESS: Query returned non-zero value: 18
Raw result: {"value":18}

No schema:
Query: SELECT COUNT(*) as value FROM oe_hdr WITH (NOLOCK) WHERE order_date >= DATEADD(day, -7, GETDATE())
✅ Query executed successfully in 4ms
✅ Value: 18 (type: number)
✅ SUCCESS: Query returned non-zero value: 18
Raw result: {"value":18}

--- Open Orders ---
Original query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N'

Default (dbo):
Query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N'
✅ Query executed successfully in 0ms
✅ Value: 2034 (type: number)
✅ SUCCESS: Query returned non-zero value: 2034
Raw result: {"value":2034}

No schema:
Query: SELECT COUNT(*) as value FROM oe_hdr WITH (NOLOCK) WHERE completed = 'N'
✅ Query executed successfully in 1ms
✅ Value: 2034 (type: number)
✅ SUCCESS: Query returned non-zero value: 2034
Raw result: {"value":2034}

--- Open Orders 2 ---
Original query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.completed = 'N'

Default (dbo):
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.completed = 'N'
✅ Query executed successfully in 129ms
✅ Value: 24643150.24 (type: number)
✅ SUCCESS: Query returned non-zero value: 24643150.24
Raw result: {"value":24643150.24}

No schema:
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM oe_hdr h WITH (NOLOCK) JOIN oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.completed = 'N'
✅ Query executed successfully in 201ms
✅ Value: 24643150.24 (type: number)
✅ SUCCESS: Query returned non-zero value: 24643150.24
Raw result: {"value":24643150.24}

--- Daily Revenue ---
Original query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE CONVERT(date, h.order_date) = CONVERT(date, DATEADD(day, -1, GETDATE()))

Default (dbo):
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE CONVERT(date, h.order_date) = CONVERT(date, DATEADD(day, -1, GETDATE()))
✅ Query executed successfully in 40ms
✅ Value: 75500 (type: number)
✅ SUCCESS: Query returned non-zero value: 75500
Raw result: {"value":75500}

No schema:
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM oe_hdr h WITH (NOLOCK) JOIN oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE CONVERT(date, h.order_date) = CONVERT(date, DATEADD(day, -1, GETDATE()))
✅ Query executed successfully in 31ms
✅ Value: 75500 (type: number)
✅ SUCCESS: Query returned non-zero value: 75500
Raw result: {"value":75500}

--- Open Invoices ---
Original query: SELECT COUNT(*) as value FROM dbo.invoice_hdr WITH (NOLOCK) WHERE invoice_date >= DATEADD(month, -1, GETDATE())

Default (dbo):
Query: SELECT COUNT(*) as value FROM dbo.invoice_hdr WITH (NOLOCK) WHERE invoice_date >= DATEADD(month, -1, GETDATE())
✅ Query executed successfully in 1ms
✅ Value: 1 (type: number)
✅ SUCCESS: Query returned non-zero value: 1
Raw result: {"value":1}

No schema:
Query: SELECT COUNT(*) as value FROM invoice_hdr WITH (NOLOCK) WHERE invoice_date >= DATEADD(month, -1, GETDATE())
✅ Query executed successfully in 2ms
✅ Value: 1 (type: number)
✅ SUCCESS: Query returned non-zero value: 1
Raw result: {"value":1}

--- Orders Backlogged ---
Original query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N' AND order_date >= DATEADD(day, -30, GETDATE())

Default (dbo):
Query: SELECT COUNT(*) as value FROM dbo.oe_hdr WITH (NOLOCK) WHERE completed = 'N' AND order_date >= DATEADD(day, -30, GETDATE())
✅ Query executed successfully in 3ms
✅ Value: 27 (type: number)
✅ SUCCESS: Query returned non-zero value: 27
Raw result: {"value":27}

No schema:
Query: SELECT COUNT(*) as value FROM oe_hdr WITH (NOLOCK) WHERE completed = 'N' AND order_date >= DATEADD(day, -30, GETDATE())
✅ Query executed successfully in 1ms
✅ Value: 27 (type: number)
✅ SUCCESS: Query returned non-zero value: 27
Raw result: {"value":27}

--- Total Monthly Sales ---
Original query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.order_date >= DATEADD(day, -30, GETDATE())

Default (dbo):
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM dbo.oe_hdr h WITH (NOLOCK) JOIN dbo.oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.order_date >= DATEADD(day, -30, GETDATE())
✅ Query executed successfully in 8ms
✅ Value: 1708263.24 (type: number)
✅ SUCCESS: Query returned non-zero value: 1708263.24
Raw result: {"value":1708263.24}

No schema:
Query: SELECT ISNULL(SUM(l.extended_price), 0) as value FROM oe_hdr h WITH (NOLOCK) JOIN oe_line l WITH (NOLOCK) ON h.order_no = l.order_no WHERE h.order_date >= DATEADD(day, -30, GETDATE())
✅ Query executed successfully in 9ms
✅ Value: 1708263.24 (type: number)
✅ SUCCESS: Query returned non-zero value: 1708263.24
Raw result: {"value":1708263.24}

--- Connection closed ---
